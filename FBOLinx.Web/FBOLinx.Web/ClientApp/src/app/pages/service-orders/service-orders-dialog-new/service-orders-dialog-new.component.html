<h1 mat-dialog-title>New Service Order</h1>
<div mat-dialog-content>

    <div *ngIf="!customerInfoByGroupDataSource">
        <mat-progress-bar mode="indeterminate"></mat-progress-bar>
    </div>
    <div *ngIf="customerInfoByGroupDataSource">
        <mat-form-field *ngIf="customerInfoByGroupDataSource && customerInfoByGroupDataSource.length > 0">
            <mat-select (selectionChange)="onCustomerInfoByGroupChanged()"
                        [(ngModel)]="data.customerInfoByGroup"
                        id="ddlCustomerInfoByGroup"
                        name="ddlCustomerInfoByGroup"
                        placeHolder="Customer">
                <mat-option *ngFor="let customerInfoByGroup of customerInfoByGroupDataSource"
                            [value]="customerInfoByGroup">{{ customerInfoByGroup.company }}</mat-option>
            </mat-select>
        </mat-form-field>

        <mat-form-field>
            <mat-select [disabled]="!data.customerInfoByGroup"
                        [required]="true"
                        (selectionChange)="onCustomerAircraftChanged()"
                        [(ngModel)]="data.customerAircraft"
                        id="ddlCustomerAircraft"
                        name="ddlCustomerAircraft"
                        placeHolder="Tail Number">
                <mat-option *ngFor="let customerAircraft of customerAircraftsDataSource"
                            [value]="customerAircraft">{{ customerAircraft.tailNumber }}</mat-option>
            </mat-select>
        </mat-form-field>

        <mat-form-field>
            <input (dateChange)="onArrivalDateTimeLocalChanged()"
                   (focus)="arrivalDateTimeLocal.open()"
                   [(ngModel)]="data.arrivalDateTimeLocal"
                   [ngxMatDatetimePicker]="arrivalDateTimeLocal"
                   matInput
                   name="arrivalDateTimeLocal"
                   placeholder="Arrival Date (Local)" />
            <mat-datepicker-toggle [for]="arrivalDateTimeLocal"
                                   matSuffix></mat-datepicker-toggle>
            <ngx-mat-datetime-picker #arrivalDateTimeLocal
                                     disabled="false"></ngx-mat-datetime-picker>
        </mat-form-field>

        <mat-form-field>
            <input (dateChange)="onDepartureDateTimeLocalChanged()"
                   (focus)="departureDateTimeLocal.open()"
                   [(ngModel)]="data.departureDateTimeLocal"
                   [ngxMatDatetimePicker]="departureDateTimeLocal"
                   matInput
                   name="departureDateTimeLocal"
                   placeholder="Departure Date (Local)" />
            <mat-datepicker-toggle [for]="departureDateTimeLocal"
                                   matSuffix></mat-datepicker-toggle>
            <ngx-mat-datetime-picker #departureDateTimeLocal
                                     disabled="false"></ngx-mat-datetime-picker>
        </mat-form-field>
    </div>
    
</div>
<div *ngIf="errorMessage != ''" class="mt-2 text-center" style="color: red">
    <p>{{errorMessage}}</p>
</div>
<div class="mt-2 text-center">
    <button (click)="onSaveChanges()"
            class="mr-1"
            color="accent"
            [disabled]="!data.arrivalDateTimeLocal || !data.departureDateTimeLocal || !data.customerAircraft || !data.customerInfoByGroup"
            mat-flat-button>
        Add Service Order
    </button>
    <button (click)="onCancelClick()" mat-stroked-button>Cancel</button>
</div>
