<div class="navbar-wrap">
    <div (click)="openSidebar()" [ngClass]="{ open: openedSidebar }" class="navbar-button">
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
    </div>

    <h1 class="page-title">{{ title }}</h1>
    <button (click)="showWidget()" mat-stroked-button style="margin-right:10px; width: 10%; min-width: 100px;">Live
        Chat
    </button>
    <h2 *ngIf="fbo && fbo.fbo && fboAirport && fboAirport.icao" class="page-info">{{ fbo.fbo }}
        / {{ fboAirport.icao }}</h2>
    <div class="nav-items">
        <div *ngIf="notificationVisible" [ngClass]="{ opened: needsAttentionMenu.isOpened }" class="nav-item">
            <a (click)="openUpdate()" class="nav-link">
                <span class="icon sli-bell"></span>
                <span
                    [ngClass]="{marker:(needsAttentionCustomersData && needsAttentionCustomersData.length > 0) || (hasLoadedJetACost && !currrentJetACostPricing) || (hasLoadedJetARetail && !currrentJetARetailPricing)}"></span>
            </a>

            <div class="dropdown-menu">
                <h4 *ngIf="
                    (hasLoadedJetACost && !currrentJetACostPricing) ||
                    (hasLoadedJetARetail && !currrentJetARetailPricing) ||
                    (needsAttentionCustomersData &&
                    needsAttentionCustomersData.length>
                    0)
                    "
                    class="menu-title"
                >
                    Notifications
                </h4>

                <ul class="notifications-list">
                    <!--JetA Cost Notification-->
                    <li *ngIf="hasLoadedJetACost && !currrentJetACostPricing">
                        <a>
                            <span class="icon sli-feed"></span>
                            <div class="content">
                                <span class="desc">Your cost pricing has expired!</span>
                                <span class="date"></span>
                                <div class="text-right">
                                    <button (click)="updatePricingClicked()"
                                            [view]="'accent'"
                                            class="mr-1"
                                            ni-button
                                            size="small">
                                        Update Pricing
                                    </button>
                                </div>
                            </div>
                        </a>
                    </li>

                    <!--JetA Retail Notification-->
                    <li *ngIf="
                            hasLoadedJetARetail && !currrentJetARetailPricing
                        ">
                        <a>
                            <span class="icon sli-feed"></span>
                            <div class="content">
                                <span class="desc">Your retail pricing has expired!</span>
                                <span class="date"></span>
                                <div class="text-right">
                                    <button (click)="updatePricingClicked()"
                                            [view]="'accent'"
                                            class="mr-1"
                                            ni-button
                                            size="small">
                                        Update Pricing
                                    </button>
                                </div>
                            </div>
                        </a>
                    </li>

                    <!--Customers without margins-->
                    <li *ngFor="let customer of needsAttentionCustomersData">
                        <a>
                            <span class="icon sli-exclamation"></span>
                            <div class="content">
                                <span class="desc">
                                    Needs Attention for
                                    <strong>{{ customer.company }}</strong>.
                                </span>
                                <span class="date"></span>
                                <div class="text-right">
                                    <button (click)="gotoCustomer(customer)"
                                            [view]="'success'"
                                            class="mr-1"
                                            ni-button
                                            size="small">
                                        See customer
                                    </button>
                                </div>
                            </div>
                        </a>
                    </li>
                </ul>

                <div class="menu-footer">
                    <a (click)="viewAllNotificationsClicked()" routerLink=".">View all notifications</a>
                </div>
            </div>
        </div>

        <div [ngClass]="{ opened: accountProfileMenu.isOpened }"
             class="nav-item">
            <a (click)="toggleProfileMenu()" class="nav-link">
                <div *ngIf="userFullName" class="name">{{ userFullName }}</div>
            </a>
            <mat-spinner *ngIf="!isLocationsLoaded" diameter="30"></mat-spinner>

            <div *ngIf="isLocationsLoaded" class="dropdown-menu mini-menu">
                <ul>
                    <li>
                        <a (click)="accountProfileClicked()"
                           style="cursor: pointer;">
                            <span class="icon sli-settings"></span> Account
                            Profile
                        </a>
                    </li>
                    <li *ngIf="currentUser && currentUser.impersonatedRole > 0 && fboAirport" class="nav-sub-item">
                        <a style="cursor: pointer;">
                            <span class="icon sli-arrow-left"></span>
                            Switch Location
                        </a>
                        <mat-list class="nav-sub-item-menu">
                            <mat-list-item (click)="changeLocation(location)"
                                           *ngFor="let location of locations">
                                <span *ngIf="location.oid == fboAirport.fboid"
                                      class="icon sli-flag"></span>&nbsp;
                                {{ location.icao }}
                            </mat-list-item>
                        </mat-list>
                    </li>
                    <li *ngIf="currentUser && currentUser.impersonatedRole === 1">
                        <a (click)="stopManagingFBOClicked()" style="cursor: pointer;">
                            <span class="icon sli-settings"></span>
                            Stop Managing FBO
                        </a>
                    </li>
                    <li *ngIf="currentUser && currentUser.impersonatedRole === 2">
                        <a (click)="stopManagingGroupClicked()" style="cursor: pointer;">
                            <span class="icon sli-settings"></span>
                            Stop Managing Group
                        </a>
                    </li>
                    <li>
                        <a (click)="logout()" style="cursor: pointer;">
                            <span class="icon sli-logout"></span> Log Out
                        </a>
                    </li>
                </ul>
            </div>
        </div>

        <div (click)="close()" class="items-overlay"></div>
    </div>
</div>
